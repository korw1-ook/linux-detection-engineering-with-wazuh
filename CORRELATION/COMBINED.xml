<!-- Slow brute force from same IP -->
<rule id="120010" level="10" frequency="20" timeframe="3600">
  <if_sid>5716</if_sid>
  <match>Failed password for</match>
  <same_source_ip>true</same_source_ip>
  <description>Slow brute force: same IP failed 20 SSH logins in 1 hour</description>
  <group>ssh,bruteforce,linux</group>
</rule>

<!-- Successful login AFTER slow brute force (BREACH MOMENT) -->
<rule id="120012" level="12" frequency="1" timeframe="3600">
  <if_sid>5715</if_sid>
  <if_matched_sid>120010</if_matched_sid>
  <same_source_ip>true</same_source_ip>
  <description>SSH SUCCESS after failed attempts (possible credential compromise)</description>
  <group>ssh,breach,compromise,linux</group>
</rule>

<!-- Priv escalation attempt AFTER breach -->
<rule id="120013" level="12" timeframe="900">
  <if_sid>5402</if_sid>
  <if_matched_sid>120012</if_matched_sid>
  <same_source_ip>true</same_source_ip>
  <description>SSH login â†’ sudo used immediately (possible privilege escalation)</description>
  <group>ssh,privilege_escalation,linux</group>
</rule>

<!-- Password spray detection (same IP, 5 different usernames) -->
<rule id="120011" level="12" frequency="5" timeframe="600">
  <if_sid>5716</if_sid>
  <match>Failed password for</match>
  <distinct_fields>user</distinct_fields>
  <same_source_ip>true</same_source_ip>
  <description>Password spray: same IP tried 5 different usernames</description>
  <group>ssh,password_spray,bruteforce,linux</group>
</rule>

<!-- Suspicious successful login from unusual country -->
<rule id="120014" level="12">
  <if_sid>5715</if_sid>
  <not_geoip>IN</not_geoip>
  <description>SSH login success from unusual country</description>
  <group>ssh,geoip,anomaly,compromise,linux</group>
</rule>
